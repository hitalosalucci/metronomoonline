window.AudioContext=window.AudioContext||window.webkitAudioContext;var context=new AudioContext,accentPitch=380,offBeatPitch=200;const tocar=document.getElementById("tocar_btn"),bpm_range=document.getElementById("input_bpm_range"),volume_tempo_range=document.getElementById("input_volume_tempos"),volume_marcador_range=document.getElementById("input_volume_marcador"),volume_divisao_range=document.getElementById("input_volume_divisao"),bpm_txt=document.getElementById("input_bpm_txt"),bpm_mais=document.getElementById("mais_bpm_btn"),bpm_menos=document.getElementById("menos_bpm_btn"),tap_btn=document.getElementById("tap_tempo_btn"),audio_divisao=document.getElementById("audio_divisao"),andamento=document.getElementById("andamento_titulo"),numero_tempo=document.getElementById("numero_tempo");var qnt_compasso_sel=document.getElementById("qnt_compasso_sel"),qnt_compasso_sel_valor=parseInt(qnt_compasso_sel.options[qnt_compasso_sel.selectedIndex].value),qnt_divisao_sel=document.getElementById("qnt_divisao_sel"),qnt_divisao_sel_valor=parseInt(qnt_divisao_sel.options[qnt_divisao_sel.selectedIndex].value),marcador_check=document.getElementById("marcador_check"),som_sel=document.getElementById("som_sel"),som_sel_valor=parseInt(som_sel.options[som_sel.selectedIndex].value);qnt_compasso_sel_valor+=1;let tempo_divisao=null,currentBpm=60,tempo=null,tocando_agr=!1,tempo_passado=0,tick_contar=0,tick_contar_divisao=0;var delta=0;function verificar_som(){1==som_sel_valor?(audio=document.getElementById("sub1"),audio_marcador=document.getElementById("marc1")):2==som_sel_valor?(audio=document.getElementById("sub2"),audio_marcador=document.getElementById("marc2")):3==som_sel_valor?(audio=document.getElementById("sub3"),audio_marcador=document.getElementById("marc3")):4==som_sel_valor?(audio=document.getElementById("sub4"),audio_marcador=document.getElementById("marc4")):5==som_sel_valor?(audio=document.getElementById("sub5"),audio_marcador=document.getElementById("marc5")):6==som_sel_valor?(audio=document.getElementById("sub6"),audio_marcador=document.getElementById("marc6")):7==som_sel_valor?(audio=document.getElementById("sub7"),audio_marcador=document.getElementById("marc7")):8==som_sel_valor?(audio=document.getElementById("sub8"),audio_marcador=document.getElementById("marc8")):9==som_sel_valor&&(audio=document.getElementById("sub9"),audio_marcador=document.getElementById("marc9"))}function iniciar(){verificar_som(),audio.currentTime=0,audio.play(),contar();var e=context.createOscillator();$(".dot").eq(tick_contar-1).hasClass("active")?e.frequency.value=accentPitch:e.frequency.value=offBeatPitch,e.connect(context.destination),$(".dot").attr("style",""),$("#marcador_check").is(":checked")?$(".dot-active").css({background:"#01579b"}):$(".dot-active").css({background:"#bbbbbb"}),$(".dot").eq(tick_contar-1).css({transform:"translateY(-5px)",background:"#ef6c00"})}function iniciar_divisao(){1!=qnt_divisao_sel_valor&&(audio_divisao.currentTime=0,audio_divisao.play(),contar_divisao())}function contar(){(tick_contar+=1)==qnt_compasso_sel_valor&&(tick_contar=qnt_compasso_sel_valor,tick_contar=1),numero_tempo.innerHTML="<strong>"+tick_contar+"</strong>",verificarCheckMarcador()}function contar_divisao(){tick_contar_divisao+=1,qnt_divisao_sel_valorm=parseInt(qnt_divisao_sel_valor)+1,tick_contar_divisao==qnt_divisao_sel_valorm&&(tick_contar_divisao=1),console.log(tick_contar_divisao),verificarDivisaoMute()}function verificarCheckMarcador(){$("#marcador_check").is(":checked")?1==tick_contar?(audio.muted=!0,audio_marcador.play()):1!=tick_contar&&(audio.muted=!1):audio.muted=!1}function verificarDivisaoMute(){audio_divisao.muted=1==tick_contar_divisao}function parar(){clearInterval(tempo),clearInterval(tempo_divisao),tick_contar=0,tick_contar_divisao=0,$(".dot").css({transform:"translateY(0px)",background:"#bbbbbbdd"}),$("#marcador_check").is(":checked")?$(".dot-active").css({transform:"translateY(0px)",background:"#01579b"}):0==$("#marcador_check").is(":checked")&&$(".dot-active").css({transform:"translateY(0px)",background:"#bbbbbbdd"})}function ValorAndamento(){currentBpm<40?andamento.innerHTML="Andamento: <strong>Grave</strong>":currentBpm>=40&&currentBpm<45?andamento.innerHTML="Andamento: <strong>Larghissimo</strong>":currentBpm>=45&&currentBpm<50?andamento.innerHTML="Andamento: <strong>Largo</strong>":currentBpm>=50&&currentBpm<55?andamento.innerHTML="Andamento: <strong>Larghetto</strong>":currentBpm>=55&&currentBpm<65?andamento.innerHTML="Andamento: <strong>Adagio</strong>":currentBpm>=65&&currentBpm<78?andamento.innerHTML="Andamento: <strong>Adagietto</strong>":currentBpm>=78&&currentBpm<83?andamento.innerHTML="Andamento: <strong>Andantino</strong>":currentBpm>=83&&currentBpm<85?andamento.innerHTML="Andamento: <strong>Marcia Moderato</strong>":currentBpm>=85&&currentBpm<90?andamento.innerHTML="Andamento: <strong>Andante</strong>":currentBpm>=90&&currentBpm<100?andamento.innerHTML="Andamento: <strong>Andante Moderato</strong>":currentBpm>=100&&currentBpm<112?andamento.innerHTML="Andamento: <strong>Moderato</strong>":currentBpm>=112&&currentBpm<116?andamento.innerHTML="Andamento: <strong>Allegro Moderato</strong>":currentBpm>=116&&currentBpm<120?andamento.innerHTML="Andamento: <strong>Allegretto</strong>":currentBpm>=120&&currentBpm<140?andamento.innerHTML="Andamento: <strong>Allegro</strong>":currentBpm>=140&&currentBpm<160?andamento.innerHTML="Andamento: <strong>Vivace</strong>":currentBpm>=160&&currentBpm<168?andamento.innerHTML="Andamento: <strong>Vivacissimo</strong>":currentBpm>=168&&currentBpm<180?andamento.innerHTML="Andamento: <strong>Alegricissimo</strong>":currentBpm>=180&&currentBpm<200?andamento.innerHTML="Andamento: <strong>Presto</strong>":currentBpm>=200&&(andamento.innerHTML="Andamento: <strong>Prestissimo</strong>")}function reiniciar_metronomo(){parar(),iniciar(),iniciar_divisao(),tempo=setInterval(iniciar,6e4/currentBpm),tempo_divisao=setInterval(iniciar_divisao,6e4/currentBpm/qnt_divisao_sel_valor)}$("#marcador_check").on("click",function(){$("#marcador_check").is(":checked")?$(".dot-active").css({transform:"translateY(0px)",background:"#01579b"}):$(".dot-active").css({transform:"translateY(0px)",background:"#bbbbbb"})}),som_sel.addEventListener("change",function(){som_sel_valor=som_sel.options[som_sel.selectedIndex].value=this.value,document.getElementById("input_volume_tempos").value=1,document.getElementById("input_volume_marcador").value=1,document.getElementById("input_volume_divisao").value=1,audio.volume=volume_tempo_range.value=1,audio_marcador.volume=volume_marcador_range.value=1,audio_divisao.volume=volume_divisao_range.value=1,verificar_som(),tocando_agr&&reiniciar_metronomo()}),volume_tempo_range.addEventListener("change",function(){audio.volume=volume_tempo_range.value}),volume_marcador_range.addEventListener("change",function(){audio_marcador.volume=volume_marcador_range.value}),volume_divisao_range.addEventListener("change",function(){audio_divisao.volume=volume_divisao_range.value}),$("#qnt_compasso_sel").on("change",function(){qnt_compasso_sel_valor=qnt_compasso_sel.options[qnt_compasso_sel.selectedIndex].value=this.value,qnt_compasso_sel_valor=parseInt(qnt_compasso_sel_valor)+1,tocando_agr&&(tick_contar=qnt_compasso_sel_valor,tick_contar=0,tick_contar_divisao=0,reiniciar_metronomo());var e=$(".animacao_counter");e.html("");for(var t=0;t<parseInt(qnt_compasso_sel_valor-1,10);t++){var n=document.createElement("div");n.className="dot",0===t&&(n.className+=" dot-active"),e.append(n)}}),qnt_divisao_sel.addEventListener("change",function(){qnt_divisao_sel_valor=qnt_divisao_sel.options[qnt_divisao_sel.selectedIndex].value=this.value,tocando_agr&&(tick_contar=qnt_compasso_sel_valor,tick_contar=0,tick_contar_divisao=qnt_divisao_sel_valor,tick_contar_divisao=0,reiniciar_metronomo())}),bpm_range.addEventListener("change",function(){document.getElementById("input_bpm_txt").value=this.value,currentBpm=parseInt(this.value),tocando_agr&&reiniciar_metronomo(),ValorAndamento()}),bpm_txt.addEventListener("change",function(){document.getElementById("input_bpm_range").value=this.value,(currentBpm=parseInt(this.value))>260&&(currentBpm=260,document.getElementById("input_bpm_range").value=260,document.getElementById("input_bpm_txt").value=260),currentBpm<20&&(currentBpm=20,document.getElementById("input_bpm_range").value=20,document.getElementById("input_bpm_txt").value=20),ValorAndamento(),tocando_agr&&reiniciar_metronomo()}),bpm_mais.addEventListener("click",function(){currentBpm<260&&currentBpm++,document.getElementById("input_bpm_txt").value=currentBpm,document.getElementById("input_bpm_range").value=currentBpm,tocando_agr&&reiniciar_metronomo(),ValorAndamento()}),bpm_menos.addEventListener("click",function(){currentBpm>20&&currentBpm--,document.getElementById("input_bpm_txt").value=currentBpm,document.getElementById("input_bpm_range").value=currentBpm,tocando_agr&&reiniciar_metronomo(),ValorAndamento()}),tocar.addEventListener("click",function(){tocando_agr?(parar(),tocar.innerHTML="Iniciar",numero_tempo.innerHTML="<strong>--</strong>",tocar.classList.remove("orange"),tocar.classList.remove("darken-3"),tocar.classList.add("green")):(tocar.innerHTML="Parar",iniciar(),iniciar_divisao(),tempo=setInterval(iniciar,6e4/currentBpm),tempo_divisao=setInterval(iniciar_divisao,6e4/currentBpm/qnt_divisao_sel_valor),tocar.classList.remove("green"),tocar.classList.add("orange"),tocar.classList.add("darken-3")),tocando_agr=!tocando_agr}),$("#tap_tempo_btn").click(function(){var e=new Date,t=parseInt(e.getTime(),10);$("#input_bpm_txt").val(Math.ceil(6e4/(t-delta))),$("#input_bpm_range").val(Math.ceil(6e4/(t-delta))),(currentBpm=Math.ceil(6e4/(t-delta)))>260&&(currentBpm=260,document.getElementById("input_bpm_range").value=260,document.getElementById("input_bpm_txt").value=260),currentBpm<20&&(currentBpm=20,document.getElementById("input_bpm_range").value=20,document.getElementById("input_bpm_txt").value=20),tocando_agr&&reiniciar_metronomo(),delta=t});